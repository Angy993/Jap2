<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>Quiz Romaji Interattivo</title>
  <style>
    body {
      margin: 0;
      background: #f4f6f9;
      font-family: 'Helvetica Neue', sans-serif;
    }
    .layout {
      display: flex;
      max-width: 1300px;
      margin: 0 auto;
      padding: 40px;
      gap: 30px;
    }
    .container {
      flex: 1;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 0 12px rgba(0,0,0,0.05);
      padding: 30px;
    }
    .quiz-title {
      font-size: 28px;
      margin-bottom: 20px;
      text-align: center;
      color: #2a5d84;
      animation: fadeIn 1s ease-in-out;
    }
    .question {
      font-size: 22px;
      text-align: center;
      margin-bottom: 15px;
    }
    .input-group {
      text-align: center;
    }
    input {
      font-size: 20px;
      padding: 10px;
      width: 320px;
      border: 1px solid #ccc;
      border-radius: 6px;
    }
    button {
      font-size: 16px;
      padding: 10px 20px;
      margin-left: 10px;
      background: #2a5d84;
      color: white;
      border: none;
      border-radius: 6px;
      cursor: pointer;
    }
    .result {
      font-size: 18px;
      margin-top: 30px;
      line-height: 1.6;
    }
    .explanation {
      background: #eef3f8;
      padding: 14px;
      margin-top: 15px;
      border-left: 4px solid #2a5d84;
      border-radius: 4px;
    }
    .sidebar {
      width: 280px;
      background: #ffffff;
      border-radius: 12px;
      box-shadow: 0 0 10px rgba(0,0,0,0.04);
      padding: 25px;
      height: fit-content;
    }
    .sidebar h3 {
      margin-top: 0;
      font-size: 20px;
      color: #2a5d84;
    }
    .sidebar ul {
      list-style: none;
      padding-left: 0;
    }
    .sidebar li {
      margin-bottom: 10px;
    }
    .blur {
      filter: blur(5px);
      transition: filter 0.3s;
      cursor: pointer;
    }
    .blur:hover {
      filter: blur(0);
    }
    .version {
      position: fixed;
      top: 10px;
      right: 20px;
      font-size: 13px;
      color: #888;
      font-style: italic;
    }
    .language-toggle {
      text-align: center;
      margin-bottom: 20px;
    }
    .language-toggle select {
      font-size: 16px;
      padding: 6px 10px;
      border-radius: 5px;
    }
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(-10px); }
      to { opacity: 1; transform: translateY(0); }
    }
  </style>
</head>
<body>
  <div class="version">Versione 4.0</div>
  <div class="layout">
    <div class="container">
      <div class="quiz-title">Quiz di Romaji Giapponese</div>
      <div class="language-toggle">
        <label for="lang">Lingua:</label>
        <select id="lang">
          <option value="it">Italiano</option>
          <option value="en">English</option>
        </select>
      </div>
      <div id="question" class="question"></div>
      <div class="input-group">
        <input type="text" id="userInput" placeholder="Scrivi in romaji">
        <button onclick="checkAnswer()">Verifica</button>
      </div>
      <div class="result" id="result"></div>
      <div id="spiegazioni"></div>
    </div>
    <div class="sidebar">
      <h3>Parole Imparate</h3>
      <ul id="sidebarList"></ul>
    </div>
  </div>

  <script>
    const langSelector = document.getElementById("lang");

    const data = [
      {
        romaji: "taberu",
        italiano: "Mangiare",
        inglese: "To eat",
        emoji: "üçö",
        frase: "Watashi wa gohan o taberu.",
        traduzione_it: "Mangio riso.",
        traduzione_en: "I eat rice.",
        spiegazioni: {
          wa: {
            descrizione: "Particella del tema.",
            uso: "Indica l'argomento principale.",
            esempio: "Watashi wa gakusei desu.",
            nota: "Si scrive „ÅØ ma si legge 'wa'."
          },
          o: {
            descrizione: "Particella oggetto diretto.",
            uso: "Collega oggetto e verbo.",
            esempio: "Ringo o taberu.",
            nota: "Si scrive „Çí ma si legge 'o'."
          }
        }
      },
      {
        romaji: "nomu",
        italiano: "Bere",
        inglese: "To drink",
        emoji: "üßÉ",
        frase: "Watashi wa mizu o nomu.",
        traduzione_it: "Bevo acqua.",
        traduzione_en: "I drink water.",
        spiegazioni: {
          wa: {
            descrizione: "Particella del tema.",
            uso: "Indica il soggetto della frase.",
            esempio: "Watashi wa gakusei desu.",
            nota: "Si scrive „ÅØ ma si legge 'wa'."
          },
          o: {
            descrizione: "Particella oggetto diretto.",
            uso: "Collega oggetto e verbo.",
            esempio: "Mizu o nomu.",
            nota: "Si scrive „Çí ma si legge 'o'."
          }
        }
      },
      {
        romaji: "miru",
        italiano: "Guardare",
        inglese: "To watch",
        emoji: "üëÄ",
        frase: "Anime o miru.",
        traduzione_it: "Guardo anime.",
        traduzione_en: "I watch anime.",
        spiegazioni: {
          o: {
            descrizione: "Particella oggetto diretto.",
            uso: "Collega oggetto e verbo.",
            esempio: "Anime o miru.",
            nota: "Si scrive „Çí ma si legge 'o'."
          }
        }
      },
      {
        romaji: "tanoshii",
        italiano: "Divertente",
        inglese: "Fun",
        emoji: "üéâ",
        frase: "Kono asobi wa tanoshii.",
        traduzione_it: "Questo gioco √® divertente.",
        traduzione_en: "This game is fun.",
        spiegazioni: {
          wa: {
            descrizione: "Particella del tema.",
            uso: "Identifica l'argomento.",
            esempio: "Kono hon wa omoshiroi.",
            nota: "Si scrive „ÅØ ma si legge 'wa'."
          }
        }
      }
      // Puoi continuare ad aggiungere tutte le parole nella stessa struttura
    ];

    let index = 0;

    function getCurrentLang() {
      return langSelector.value;
    }

    function loadQuestion() {
      document.getElementById("userInput").value = "";
      document.getElementById("result").innerHTML = "";
      document.getElementById("spiegazioni").innerHTML = "";
      if (index < data.length) {
        const lang = getCurrentLang();
        const parola = lang === "en" ? data[index].inglese : data[index].italiano;
        document.getElementById("question").innerHTML = `<strong>${data[index].emoji} Traduci:</strong> ${parola}`;
      } else {
        document.getElementById("question").innerHTML = "Hai completato il quiz!";
        document.querySelector(".input-group").style.display = "none";
      }
    }

    function checkAnswer() {
      const input = document.getElementById("userInput").value.trim().toLowerCase();
      const correct = data[index].romaji.toLowerCase();

      if (input === correct) {
        const lang = getCurrentLang();
        const frase = data[index].frase;
        const trad = lang === "en" ? data[index].traduzione_en : data[index].traduzione_it;
        let result = `<strong>Frase:</strong><br>${frase}<br><em>${trad}</em><br>`;
        document.getElementById("result").innerHTML = result;

        const spiegazioni = data[index].spiegazioni || {};
        let spiegaHtml = "";
        for (let part in spiegazioni) {
          const s = spiegazioni[part];
          spiegaHtml += `<div class='explanation'><strong>${part}</strong><br>
            <em><strong>Descrizione:</strong></em> ${s.descrizione}<br>
            <em><strong>Uso:</strong></em> ${s.uso}<br>
            <em><strong>Esempio:</strong></em> ${s.esempio}<br>
            <em><strong>Nota:</strong></em> ${s.nota}</div>`;
        }
        document.getElementById("spiegazioni").innerHTML = spiegaHtml;
      } else {
        document.getElementById("result").innerHTML = "<span style='color:red;'>‚úó Risposta sbagliata. Riprova.</span>";
      }
    }

    function popolaSidebar() {
      const sidebar = document.getElementById("sidebarList");
      sidebar.innerHTML = "";
      data.forEach(entry => {
        const li = document.createElement("li");
        li.innerHTML = `<span class="blur">${entry.romaji}</span> ‚Äì ${entry.italiano}`;
        sidebar.appendChild(li);
      });
    }

    document.getElementById("userInput").addEventListener("keydown", function(event) {
      if (event.key === "Enter") checkAnswer();
    });

    document.addEventListener("keydown", function(event) {
      if (event.key === "q" || event.key === "ArrowRight") {
        index++;
        loadQuestion();
      }
    });

    langSelector.addEventListener("change", loadQuestion);

    window.onload = () => {
      loadQuestion();
      popolaSidebar();
    };
  </script>
</body>
</html>
